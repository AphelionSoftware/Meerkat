<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/13/2014 2:20:45 PM"
  DTS:CreationName="SSIS.Package.3"
  DTS:CreatorComputerName="MGS-M6700"
  DTS:CreatorName="MGS2012\administrator"
  DTS:DTSID="{33B50CC9-3B7E-4DB2-B0C4-9E674EE518E5}"
  DTS:ExecutableType="SSIS.Package.3"
  DTS:LastModifiedProductVersion="11.0.3393.0"
  DTS:LocaleID="1033"
  DTS:ObjectName="000_SP_Jobs"
  DTS:PackageType="5"
  DTS:VersionBuild="9"
  DTS:VersionGUID="{AD5DFDD7-A153-42D6-A69E-578D2D7773F1}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">6</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{DFEC4D5B-392D-452B-A943-C815F822CC41}"
      DTS:ObjectName="Template">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">STS#0</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{86D8F265-4394-4BB3-823B-B894588136CF}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::Folder] + &quot;meerkat_project.cmp&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="File">
      <DTS:VariableValue
        DTS:DataType="8">D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\meerkat_project.cmp</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D4FFB51D-2AC1-40E1-8E75-EC57BBCE6497}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="REPLACE( @[$Project::GitHubRootFolder] + &quot;\\&quot; + &quot;Installation\\SP\\Export\\&quot;, &quot;\\\\&quot;, &quot;\\&quot;)"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Folder">
      <DTS:VariableValue
        DTS:DataType="8">D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{94DBD55F-81BC-4B4A-B5C5-8333AA1A70D7}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot; -ExecutionPolicy ByPass -command \&quot;. '&quot; &#xA;+ @[User::PSFile]   +&#xA; &quot;'     '&quot;&#xA;+ @[User::SiteName]   +&#xA; &quot;'     '&quot;&#xA;+ @[User::SitePath]  + &#xA;&quot;'    '&quot; &#xA;+ @[User::File]  + &#xA;&quot;'    '&quot; &#xA;+ @[$Package::Template]    + &#xA;&quot;'   \&quot;  &gt; &quot; + @[User::File] + &quot;.log&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="PSCommand">
      <DTS:VariableValue
        DTS:DataType="8"> -ExecutionPolicy ByPass -command ". 'D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\Meerkat.ImportSite.Silent.ps1'     'Test'     'http://mgs-m6700/Test'    'D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\meerkat_project.cmp'    'STS#0'   "  &gt; D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\meerkat_project.cmp.log</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3C055271-15DF-41B9-8C9D-7CC099785625}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::Folder] + &quot;Meerkat.ImportSite.Silent.ps1&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="PSFile">
      <DTS:VariableValue
        DTS:DataType="8">D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\Meerkat.ImportSite.Silent.ps1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2B95F061-EEF1-4012-A2C5-60923671AF0C}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Resultset">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7082D19F-E596-48E4-A734-F5250736F811}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SiteName">
      <DTS:VariableValue
        DTS:DataType="8">Test</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{679E4A2E-55C1-4107-B1BC-0351E36B95D4}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SitePath">
      <DTS:VariableValue
        DTS:DataType="8">http://mgs-m6700/Test</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\EST_GetProjects"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{26D9233B-7909-4D08-953A-7174B9E6E455}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="EST_GetProjects"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{21CDB393-558C-455B-98E5-7EFB5850E936}"
          SQLTask:SqlStatementSource="&#xA;SELECT &#xA;PR.ProjectSiteName As SiteName,&#xA; &#xA;&#x9;&#x9;(SELECT Value FROM settings.GlobalSettings WHERE Code = 'BASESITEURL' ) &#xA;&#x9;&#x9;+ P.ProgrammeSiteName  &#xA;&#x9;&#x9;+ '/'&#xA;&#x9;&#x9;+ PR.ProjectSiteName&#xA;&#xA;&#x9;AS SitePath&#xA;&#x9;   &#xA;&#xA;&#x9;   FROM app.Project PR&#xA;&#x9;   LEFT OUTER JOIN app.SubSector SS1&#xA;&#x9;&#x9;&#x9;JOIN app.Sector S1&#xA;&#x9;&#x9;&#x9;&#x9;ON SS1.Sector_ID = S1.Sector_ID&#xA;&#xA;&#x9;&#x9;ON PR.SubSector_ID = SS1.SubSector_ID&#xA; &#xA;&#x9;&#x9;LEFT OUTER JOIN app.Sector S2&#xA;&#x9;&#x9;&#x9;&#x9;ON PR.Sector_ID = S2.Sector_ID&#xA;&#x9;&#xA;&#x9;     JOIN app.Programme P&#xA;&#x9;&#x9;&#x9;ON PR.Programme_ID = P.Programme_ID&#xA;&#x9;&#x9;&#x9;OR S1.Programme_ID = P.Programme_ID&#xA;&#x9;&#x9;&#x9;OR S2.Programme_ID = P.Programme_ID&#xA;&#x9;WHERE PR.isSiteCreated = 0"
          SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::Resultset" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\FLC_CreateSites"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Foreach Loop Container"
      DTS:DTSID="{A500FE73-C2E1-451C-9318-3E47F24A39EF}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:ObjectName="FLC_CreateSites">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.SqlServer.Dts.Runtime.Enumerators.ADO.ForEachADOEnumerator, Microsoft.SqlServer.ForEachADOEnumerator, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
        DTS:DTSID="{B797841B-674C-4C45-B066-2616C62A369C}"
        DTS:ObjectName="{B797841B-674C-4C45-B066-2616C62A369C}">
        <DTS:ObjectData>
          <FEEADO
            EnumType="EnumerateRowsInFirstTable"
            VarName="User::Resultset" />
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\FLC_CreateSites\EST_UpdateCreated"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{02994327-E020-43D3-8DDC-29261BBA2A28}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="EST_UpdateCreated"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{21CDB393-558C-455B-98E5-7EFB5850E936}"
              SQLTask:SqlStatementSource="UPDATE app.Project&#xA;SET isSiteCreated = 1&#xA;where ProjectSiteName = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::SiteName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="255" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\FLC_CreateSites\Execute Process Task"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteProcess.ExecuteProcess, Microsoft.SqlServer.ExecProcTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="Execute Process Task"
          DTS:DTSID="{9BC599BB-4B45-4CBB-AB21-155B6D531481}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteProcess.ExecuteProcess, Microsoft.SqlServer.ExecProcTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="Execute Process Task"
          DTS:TaskContact="Execute Process Task;Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Arguments">@[User::PSCommand]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <ExecuteProcessData
              Executable="%windir%\\System32\\WindowsPowerShell\\v1.0\\PowerShell.exe"
              Arguments=" -ExecutionPolicy ByPass -command &quot;. 'D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\Meerkat.ImportSite.Silent.ps1'     'Test'     'http://mgs-m6700/Test'    'D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\meerkat_project.cmp'    'STS#0'   &quot;  &gt; D:\Dropbox\GitHub\Meerkat\Installation\SP\Export\meerkat_project.cmp.log" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\FLC_CreateSites.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{18990B4A-EA21-4B79-943A-6A56F2EC9B4F}"
          DTS:From="Package\FLC_CreateSites\Execute Process Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\FLC_CreateSites\EST_UpdateCreated" />
      </DTS:PrecedenceConstraints>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{F97108A8-6F86-434B-9939-8B7AA114925D}"
          DTS:ObjectName="{F97108A8-6F86-434B-9939-8B7AA114925D}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::SiteName" />
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{60EF6682-F5B5-49DF-9E03-73C409276EEA}"
          DTS:ObjectName="{60EF6682-F5B5-49DF-9E03-73C409276EEA}"
          DTS:ValueIndex="1"
          DTS:VariableName="User::SitePath" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{CC5D5735-A0FD-49A6-9B4D-8DFF6F9BAA0D}"
      DTS:From="Package\EST_GetProjects"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\FLC_CreateSites" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql11">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="157,42"
          Id="Package\EST_GetProjects"
          TopLeft="82,159" />
        <NodeLayout
          Size="180,42"
          Id="Package\FLC_CreateSites\Execute Process Task"
          TopLeft="80,31" />
        <NodeLayout
          Size="173,42"
          Id="Package\FLC_CreateSites\EST_UpdateCreated"
          TopLeft="126,148" />
        <EdgeLayout
          Id="Package\FLC_CreateSites.PrecedenceConstraints[Constraint]"
          TopLeft="170,73">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="42.5,75"
              Start="0,0"
              End="42.5,67.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,33.5"
                    Point2="0,37.5"
                    Point3="4,37.5" />
                  <mssgle:LineSegment
                    End="38.5,37.5" />
                  <mssgle:CubicBezierSegment
                    Point1="38.5,37.5"
                    Point2="42.5,37.5"
                    Point3="42.5,41.5" />
                  <mssgle:LineSegment
                    End="42.5,67.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="387,288"
          Size="387,331"
          Id="Package\FLC_CreateSites"
          TopLeft="98,277" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="160.5,201">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="131,76"
              Start="0,0"
              End="131,68.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34" />
                  <mssgle:CubicBezierSegment
                    Point1="0,34"
                    Point2="0,38"
                    Point3="4,38" />
                  <mssgle:LineSegment
                    End="127,38" />
                  <mssgle:CubicBezierSegment
                    Point1="127,38"
                    Point2="131,38"
                    Point3="131,42" />
                  <mssgle:LineSegment
                    End="131,68.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>