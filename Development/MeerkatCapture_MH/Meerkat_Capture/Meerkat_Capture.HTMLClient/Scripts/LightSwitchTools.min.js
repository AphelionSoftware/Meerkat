(function(n,t){"use strict";function i(n){if(n=="Person")return"People";var t=n+"s";return n.charAt(n.length-1).toLocaleLowerCase()==="y"&&(t=n.substring(0,n.length-1)+"ies"),t}n.setCommonAddScreenValues=function(n){var f=n.details.getModel().properties[0].name,r=n[f],i=n.findContentItem("ActualValue"),u=n.findContentItem("ActualLabel");i.dataBind("value",function(){if(i.value!==t&&i.stringValue.length>0){var n=0;u.value!==t&&(n=u.stringValue.length);n===0&&(u.stringValue=i.stringValue)}});r.ActualDate=new Date;myapp.activeDataWorkspace.MeerkatData.DataVersions_SingleOrDefault(1).execute().then(function(n){var t=n.results[0];r.setDataVersion(t)});myapp.activeDataWorkspace.MeerkatData.ActiveTypes.filter("Code eq 'Active'").execute().then(function(n){r.setActiveType(n.results[0])},function(n){msls.showMessageBox(n,{title:"Default value for ActiveType failed"})})};n.homeIcon=function(n){$(n).addClass("customHomeIcon")};n.copyIcon=function(n){$(n).addClass("customCopyIcon")};n.getClientCode=function(n){window.lsData?n(window.lsData.ClientCode):$.getJSON("/api/LightswitchHelpers",function(t){window.lsData=t;n(t.ClientCode)})};n.setDescriptionIsName=function(n){var i=n.findContentItem("Name"),r=n.findContentItem("Description"),u=n.findContentItem("TextDescription");i&&(r||u)&&i.dataBind("value",function(){var n;i.value!==t&&i.value.length>0&&u!==t&&(n=0,u.value!==t&&(n=u.value.length),n===0&&(u.value=i.value));i.value!==t&&i.value.length>0&&r!==t&&(n=0,r.value!==t&&(n=r.value.length),n===0&&(r.value=i.value))})};n.setDescriptionIsShortName=function(n){var e=n.details.getModel().properties[0].name,o=n[e],i=n.findContentItem("ShortName"),r=n.findContentItem("LongName"),u=n.findContentItem("Description"),f=n.findContentItem("TextDescription");i&&(u||f||r)&&i.dataBind("value",function(){var n;i.value!==t&&i.value.length>0&&f!==t&&(n=0,f.value!==t&&(n=f.value.length),n===0&&(f.value=i.value));i.value!==t&&i.value.length>0&&u!==t&&(n=0,u.value!==t&&(n=u.value.length),n===0&&(u.value=i.value));i.value!==t&&i.value.length>0&&r!==t&&(n=0,r.value!==t&&(n=r.value.length),n===0&&(r.value=i.value))})};n.getVersionInfo=function(n){window.lsData?n("version: "+window.lsData.Version+" (built "+window.lsData.Deployed+")"):$.getJSON("/api/LightswitchHelpers",function(t){window.lsData=t;n("version: "+t.Version+" (built "+t.Deployed+")")})};n.configureCaptureForm=function(n){var u=n.details.getModel().properties[0].name,f,h=n.details.getModel().properties[0].elementType.properties,e,s;$.each(h,function(n,t){if(t.__isKeyProperty===1)return f=t.name,!1});var r=n[u],o=r[f],c=r.ActiveType;if(o===t){n.details.displayName=n.pageTitle!==t?"Add "+n.pageTitle:"Add "+u;r.sys_CreatedBy="NA";r.sys_CreatedOn="1999/01/01";r.sys_ModifiedBy="NA";r.sys_ModifiedOn="1999/01/01";r.IndicatorValueGroup="92348bc8-685e-4cd6-b22d-d6b950ac7b53";r.MilestoneValueGroup="92348bc8-685e-4cd6-b22d-d6b950ac7b53";r.GroupVersion=1;e=n.findContentItem("ActiveType");e!==t&&(e.isVisible=!1);n.details.dataWorkspace.MeerkatData.ActiveTypes.filter("Code eq 'Active'").execute().then(function(n){r.setActiveType(n.results[0])},function(n){msls.showMessageBox(n,{title:"Default value for ActiveType failed"})});return}n.details.displayName=n.pageTitle!==t?"Edit "+n.pageTitle:"Edit "+u;s=new myapp.DataWorkspace;s.MeerkatData[i(u)].filter(f+" eq "+o).execute().then(function(n){var i=n.results[0],f,u;i!==t&&(f=r.details.properties.all(),u=!1,$.each(f,function(n,t){var f=t.name,e;t instanceof msls.Entity.Details.StorageProperty&&f[0]!=="_"&&f.substring(0,3)!=="sys"&&(e=!1,e=r.details._[f]instanceof Date?r.details._[f].toString()!==i.details._[f].toString():r.details._[f]!==i.details._[f],e&&(console.log("Detected that "+f+" has changed"),r.details._[f]=i.details._[f],t.dispatchChange("value"),r.dispatchChange(f),u=!0))}),u&&(r.details._.__metadata.etag=i.details._.__metadata.etag))},function(n){msls.showMessageBox(n,{title:"Data Refresh failed"})})}})(msls.application.lightswitchTools=msls.application.lightswitchTools||{});
//# sourceMappingURL=LightSwitchTools.min.js.map
